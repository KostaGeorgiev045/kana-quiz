<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hiragana/Katakana Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="container bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full text-center flex flex-col gap-6">
        <!-- Mode Selection -->
        <div id="mode-selection" class="flex flex-col gap-4">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Choose Your Kana</h1>
            <button id="hiragana-btn" class="px-4 py-2 bg-blue-500 text-white rounded">Hiragana</button>
            <button id="katakana-btn" class="px-4 py-2 bg-blue-500 text-white rounded">Katakana</button>
        </div>

        <!-- Question Count Selection -->
        <div id="question-count-selection" class="hidden flex flex-col gap-4">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">How Many Questions?</h1>
            <button id="20-questions-btn" class="px-4 py-2 bg-green-500 text-white rounded">20 Questions</button>
            <button id="50-questions-btn" class="px-4 py-2 bg-green-500 text-white rounded">50 Questions</button>
            <button id="unlimited-questions-btn" class="px-4 py-2 bg-green-500 text-white rounded">Unlimited Questions</button>
            <button id="back-to-mode-btn" class="mt-4 px-4 py-2 bg-gray-300 rounded">Back</button>
        </div>

        <!-- Quiz Area -->
        <div id="quiz-area" class="hidden flex flex-col gap-4">
            <div id="kana-display" class="text-6xl font-bold text-gray-800 mb-6 min-h-[6rem]"></div>
            <div id="options-container" class="grid grid-cols-2 gap-4">
                <button class="px-4 py-2 bg-gray-200 rounded answer-btn"></button>
                <button class="px-4 py-2 bg-gray-200 rounded answer-btn"></button>
                <button class="px-4 py-2 bg-gray-200 rounded answer-btn"></button>
                <button class="px-4 py-2 bg-gray-200 rounded answer-btn"></button>
            </div>
            <div id="feedback-message" class="text-lg font-medium text-center min-h-[2rem]"></div>
            <div id="score-display" class="text-gray-600">Score: 0 / 0</div>
            <div class="flex justify-between gap-4">
                <button id="next-question-btn" class="hidden mt-4 px-4 py-2 bg-indigo-500 text-white rounded">Next Question</button>
                <button id="abort-btn" class="mt-4 px-4 py-2 bg-red-500 text-white rounded">Abort Quiz</button>
            </div>
        </div>

        <!-- Quiz End Screen -->
        <div id="quiz-end-screen" class="hidden flex flex-col gap-4">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h1>
            <p id="final-score" class="text-2xl font-semibold text-gray-700"></p>
            <button id="restart-quiz-btn" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded">Start New Quiz</button>
        </div>
    </div>

    <script>
    const kanaData = {
        hiragana: [
            { char: 'あ', romaji: 'a' }, { char: 'い', romaji: 'i' }, { char: 'う', romaji: 'u' }, { char: 'え', romaji: 'e' }, { char: 'お', romaji: 'o' },
            { char: 'か', romaji: 'ka' }, { char: 'き', romaji: 'ki' }, { char: 'く', romaji: 'ku' }, { char: 'け', romaji: 'ke' }, { char: 'こ', romaji: 'ko' },
            { char: 'さ', romaji: 'sa' }, { char: 'し', romaji: 'shi' }, { char: 'す', romaji: 'su' }, { char: 'せ', romaji: 'se' }, { char: 'そ', romaji: 'so' },
            { char: 'た', romaji: 'ta' }, { char: 'ち', romaji: 'chi' }, { char: 'つ', romaji: 'tsu' }, { char: 'て', romaji: 'te' }, { char: 'と', romaji: 'to' },
            { char: 'な', romaji: 'na' }, { char: 'に', romaji: 'ni' }, { char: 'ぬ', romaji: 'nu' }, { char: 'ね', romaji: 'ne' }, { char: 'の', romaji: 'no' },
            { char: 'は', romaji: 'ha' }, { char: 'ひ', romaji: 'hi' }, { char: 'ふ', romaji: 'fu' }, { char: 'へ', romaji: 'he' }, { char: 'ほ', romaji: 'ho' },
            { char: 'ま', romaji: 'ma' }, { char: 'み', romaji: 'mi' }, { char: 'む', romaji: 'mu' }, { char: 'め', romaji: 'me' }, { char: 'も', romaji: 'mo' },
            { char: 'や', romaji: 'ya' }, { char: 'ゆ', romaji: 'yu' }, { char: 'よ', romaji: 'yo' },
            { char: 'ら', romaji: 'ra' }, { char: 'り', romaji: 'ri' }, { char: 'る', romaji: 'ru' }, { char: 'れ', romaji: 're' }, { char: 'ろ', romaji: 'ro' },
            { char: 'わ', romaji: 'wa' }, { char: 'を', romaji: 'wo' }, { char: 'ん', romaji: 'n' }
        ],
        katakana: [
            { char: 'ア', romaji: 'a' }, { char: 'イ', romaji: 'i' }, { char: 'ウ', romaji: 'u' }, { char: 'エ', romaji: 'e' }, { char: 'オ', romaji: 'o' },
            { char: 'カ', romaji: 'ka' }, { char: 'キ', romaji: 'ki' }, { char: 'ク', romaji: 'ku' }, { char: 'ケ', romaji: 'ke' }, { char: 'コ', romaji: 'ko' },
            { char: 'サ', romaji: 'sa' }, { char: 'シ', romaji: 'shi' }, { char: 'ス', romaji: 'su' }, { char: 'セ', romaji: 'se' }, { char: 'ソ', romaji: 'so' },
            { char: 'タ', romaji: 'ta' }, { char: 'チ', romaji: 'chi' }, { char: 'ツ', romaji: 'tsu' }, { char: 'テ', romaji: 'te' }, { char: 'ト', romaji: 'to' },
            { char: 'ナ', romaji: 'na' }, { char: 'ニ', romaji: 'ni' }, { char: 'ヌ', romaji: 'nu' }, { char: 'ネ', romaji: 'ne' }, { char: 'ノ', romaji: 'no' },
            { char: 'ハ', romaji: 'ha' }, { char: 'ヒ', romaji: 'hi' }, { char: 'フ', romaji: 'fu' }, { char: 'ヘ', romaji: 'he' }, { char: 'ホ', romaji: 'ho' },
            { char: 'マ', romaji: 'ma' }, { char: 'ミ', romaji: 'mi' }, { char: 'ム', romaji: 'mu' }, { char: 'メ', romaji: 'me' }, { char: 'モ', romaji: 'mo' },
            { char: 'ヤ', romaji: 'ya' }, { char: 'ユ', romaji: 'yu' }, { char: 'ヨ', romaji: 'yo' },
            { char: 'ラ', romaji: 'ra' }, { char: 'リ', romaji: 'ri' }, { char: 'ル', romaji: 'ru' }, { char: 'レ', romaji: 're' }, { char: 'ロ', romaji: 'ro' },
            { char: 'ワ', romaji: 'wa' }, { char: 'ヲ', romaji: 'wo' }, { char: 'ン', romaji: 'n' }
        ]
    };

    let selectedSet = [];
    let questions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let totalQuestions = 0;
    let unlimited = false;

    const modeSelection = document.getElementById('mode-selection');
    const countSelection = document.getElementById('question-count-selection');
    const quizArea = document.getElementById('quiz-area');
    const endScreen = document.getElementById('quiz-end-screen');
    const kanaDisplay = document.getElementById('kana-display');
    const optionsContainer = document.getElementById('options-container');
    const feedbackMessage = document.getElementById('feedback-message');
    const scoreDisplay = document.getElementById('score-display');
    const nextBtn = document.getElementById('next-question-btn');
    const abortBtn = document.getElementById('abort-btn');
    const finalScore = document.getElementById('final-score');

    document.getElementById('hiragana-btn').onclick = () => selectMode('hiragana');
    document.getElementById('katakana-btn').onclick = () => selectMode('katakana');
    document.getElementById('20-questions-btn').onclick = () => startQuiz(20);
    document.getElementById('50-questions-btn').onclick = () => startQuiz(50);
    document.getElementById('unlimited-questions-btn').onclick = () => startQuiz(null);
    document.getElementById('back-to-mode-btn').onclick = () => { countSelection.classList.add('hidden'); modeSelection.classList.remove('hidden'); };
    nextBtn.onclick = nextQuestion;
    abortBtn.onclick = resetApp;
    document.getElementById('restart-quiz-btn').onclick = resetApp;

    function selectMode(mode) {
        selectedSet = kanaData[mode];
        modeSelection.classList.add('hidden');
        countSelection.classList.remove('hidden');
    }

    function startQuiz(count) {
        unlimited = count === null;
        totalQuestions = unlimited ? Infinity : count;
        questions = unlimited ? [] : shuffleArray([...selectedSet]).slice(0, count);
        currentQuestionIndex = 0;
        score = 0;
        countSelection.classList.add('hidden');
        quizArea.classList.remove('hidden');
        updateScore();
        showQuestion();
    }

    function clearUI() {
        feedbackMessage.textContent = '';
        nextBtn.classList.add('hidden');
        for (let btn of optionsContainer.children) {
            btn.classList.remove('bg-green-200','bg-red-200');
            btn.onclick = null;
        }
    }

    function showQuestion() {
        clearUI();
        let q = unlimited ? getRandom(selectedSet) : (questions[currentQuestionIndex] || endQuiz());
        kanaDisplay.textContent = q.char;

        // Build unique options
        const opts = [q.romaji];
        while (opts.length < 4) {
            const r = getRandom(selectedSet).romaji;
            if (!opts.includes(r)) opts.push(r);
        }

        // Shuffle and assign
        const shuffledOpts = shuffleArray(opts);
        for (let i = 0; i < 4; i++) {
            const btn = optionsContainer.children[i];
            btn.textContent = shuffledOpts[i];
            btn.disabled = false;
            btn.onclick = () => checkAnswer(btn, q);
        }
    }

    function checkAnswer(btn, q) {
        const correct = btn.textContent === q.romaji;
        if (correct) {
            btn.classList.add('bg-green-200');
            feedbackMessage.textContent = 'Correct!';
            score++;
        } else {
            btn.classList.add('bg-red-200');
            feedbackMessage.textContent = `Wrong! Correct: ${q.romaji}`;
            for (let b of optionsContainer.children) {
                if (b.textContent === q.romaji) b.classList.add('bg-green-200');
            }
        }
        for (let b of optionsContainer.children) b.disabled = true;
        updateScore();
        nextBtn.classList.remove('hidden');
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (!unlimited && currentQuestionIndex >= totalQuestions) return endQuiz();
        showQuestion();
    }

    function endQuiz() {
        quizArea.classList.add('hidden');
        finalScore.textContent = `Your score: ${score}/${currentQuestionIndex}`;
        endScreen.classList.remove('hidden');
    }

    function resetApp() {
        quizArea.classList.add('hidden');
        countSelection.classList.add('hidden');
        endScreen.classList.add('hidden');
        modeSelection.classList.remove('hidden');
    }

    function updateScore() {
        scoreDisplay.textContent = `Score: ${score}/${currentQuestionIndex}`;
    }

    function shuffleArray(a) {
        const arr = a.slice();
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }

    function getRandom(a) {
        return a[Math.floor(Math.random() * a.length)];
    }
    </script>
</body>
</html>
